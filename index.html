<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trading App - Persistent Live Graph</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #071017;
      --card: #0e1620;
      --muted: #9aa7b2;
      --accent: #ff9800;
      --green: #00d27a;
      --red: #ff4d4f;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg,#031018 0%, #071017 100%);
      color:#e6eef3;
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      justify-content:center;
      padding:18px;
      min-height:100vh;
    }

    .app {
      width:100%;
      max-width:1100px;
    }

    header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:14px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .logo{
      width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#ffb86b);display:flex;align-items:center;justify-content:center;font-weight:700;color:#061018;
      box-shadow: 0 6px 18px rgba(0,0,0,0.6);
    }
    h1{font-size:18px;margin:0}
    p.sub{margin:0;color:var(--muted);font-size:13px}

    /* Layout */
    .grid{
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:16px;
      align-items:start;
    }
    @media(max-width:980px){
      .grid{ grid-template-columns: 1fr; }
    }

    /* Left column (graph + info) */
    .card{
      background:var(--card);
      border-radius:14px;
      padding:14px;
      box-shadow: 0 8px 24px rgba(3,6,10,0.6);
    }

    .graph-wrap{ position:relative; overflow:hidden; border-radius:12px; padding:10px }
    canvas{ width:100% !important; height:320px !important; display:block; border-radius:8px; background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.04)); }

    .floating-price{
      position:absolute; right:14px; top:14px; padding:8px 12px; border-radius:10px; background:rgba(3,8,12,0.6); backdrop-filter: blur(6px);
      font-weight:600; display:flex; gap:8px; align-items:center;
      box-shadow: 0 6px 18px rgba(0,0,0,0.5);
    }

    .live-info{
      display:flex;
      gap:12px;
      margin-top:12px;
      justify-content:space-between;
    }
    .info-pill{
      flex:1;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
      padding:10px; border-radius:10px; text-align:center;
    }
    .info-pill small{display:block;color:var(--muted);font-size:12px}
    .info-pill strong{display:block;margin-top:6px;font-size:16px}

    /* Right column (controls) */
    .right-col{ display:flex; flex-direction:column; gap:12px; }

    .deposit {
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .wallet {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.04));
      padding:12px;border-radius:10px; flex:1;
    }
    .wallet small{display:block;color:var(--muted);font-size:12px}
    .wallet .addr{font-weight:600; margin-top:6px; word-break:break-all; font-size:14px}

    .btn {
      background: linear-gradient(180deg,var(--accent), #ffb86b);
      border:none; color:#061018; padding:10px 12px; border-radius:10px; cursor:pointer;font-weight:700;
      box-shadow: 0 8px 14px rgba(255,152,0,0.12);
    }
    .btn.secondary{
      background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted); box-shadow:none;
    }

    .three-doughts{
      display:flex; gap:10px; margin-top:6px;
    }
    .dought{ flex:1; padding:10px; border-radius:10px; background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.03)); text-align:center }
    .dought h4{ margin:0 0 6px 0; font-size:14px; color:#ffd76a }
    .dought p{ margin:0; color:var(--muted); font-size:13px }

    .bot{
      display:flex; gap:12px; align-items:center; justify-content:center; margin-top:8px;
    }
    .bot .bot-btn{
      flex:1; padding:12px 6px; font-size:16px; border-radius:10px; cursor:pointer; border:none; font-weight:700;
      box-shadow: 0 8px 18px rgba(0,0,0,0.5);
    }
    .up{ background: linear-gradient(180deg, rgba(0,210,122,0.12), rgba(0,210,122,0.18)); color:var(--green); border:1px solid rgba(0,210,122,0.14) }
    .down{ background: linear-gradient(180deg, rgba(255,77,79,0.08), rgba(255,77,79,0.14)); color:var(--red); border:1px solid rgba(255,77,79,0.08) }

    .small-center{ text-align:center; color:var(--muted); font-size:13px; margin-top:10px }

    footer{ margin-top:14px; text-align:center; color:var(--muted); font-size:13px }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo">T</div>
        <div>
          <h1>TradeLive — Demo</h1>
          <p class="sub">Persistent live-like chart • localStorage • mobile friendly</p>
        </div>
      </div>
      <div style="text-align:right">
        <small class="sub">Status: <span id="statusText">Running</span></small>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT: Graph + live info -->
      <div>
        <div class="card graph-wrap">
          <canvas id="priceChart"></canvas>
          <div class="floating-price" id="floatingPrice">
            <span id="priceArrow">▲</span>
            <span id="priceValue">$0.00</span>
          </div>
          <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center;gap:8px">
            <div style="display:flex;gap:8px">
              <button class="btn secondary" id="pauseBtn">Pause</button>
              <button class="btn secondary" id="resumeBtn" style="opacity:0.6">Resume</button>
            </div>
            <div style="color:var(--muted);font-size:13px">Points: <span id="pointCount">0</span></div>
          </div>

          <div class="live-info" style="margin-top:12px">
            <div class="info-pill">
              <small>Wins</small>
              <strong id="wins">0</strong>
            </div>
            <div class="info-pill">
              <small>Players</small>
              <strong id="players">0</strong>
            </div>
            <div class="info-pill">
              <small>Payout</small>
              <strong id="payout">$0.00</strong>
            </div>
          </div>
        </div>

        <div class="small-center">Tip: Page refresh won't reset the graph points (saved in localStorage).</div>
      </div>

      <!-- RIGHT: Controls -->
      <div class="right-col">
        <div class="card deposit">
          <div class="wallet">
            <small>Deposit Wallet</small>
            <div class="addr" id="walletAddress">0x1234...ABCD1234efgh</div>
          </div>
          <div style="display:flex;flex-direction:column;gap:8px">
            <button class="btn" id="copyBtn">Copy</button>
            <button class="btn secondary" id="changeAddr">Change</button>
          </div>
        </div>

        <div class="card">
          <div class="three-doughts">
            <div class="dought">
              <h4>Dought 1</h4><p id="d1">0.00</p>
            </div>
            <div class="dought">
              <h4>Dought 2</h4><p id="d2">0.00</p>
            </div>
            <div class="dought">
              <h4>Dought 3</h4><p id="d3">0.00</p>
            </div>
          </div>

          <div class="bot" style="margin-top:12px">
            <button class="bot-btn up" id="btnUp">UP</button>
            <button class="bot-btn down" id="btnDown">DOWN</button>
          </div>
          <div class="small-center" style="margin-top:10px">
            <small id="botHint">Bot: —</small>
          </div>
        </div>

        <div class="card" style="text-align:center">
          <button class="btn secondary" id="clearStorage">Clear Graph Data</button>
        </div>
      </div>
    </div>

    <footer>Made quick for you — run locally or drop on static host</footer>
  </div>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script>
    /*************** Persistent live-like price chart (localStorage) ***************/

    // Config
    const STORAGE_KEY = 'tradelive_price_points_v1';
    const MAX_POINTS = 120;            // how many points to keep
    const UPDATE_MS = 900;            // new point every ~900ms
    const SMOOTH_DURATION = 500;      // chart animation duration

    // Helpers
    function loadPoints(){
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return null;
        const pts = JSON.parse(raw);
        if(Array.isArray(pts) && pts.length) return pts;
      } catch(e){ console.warn('loadPoints err', e) }
      return null;
    }
    function savePoints(arr){
      try { localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }
      catch(e){ console.warn('savePoints err', e) }
    }

    // Seed if none
    let points = loadPoints() || (function seed(){
      // create a smooth-ish seed series — less jumpy
      const start = 100 + Math.random()*6;
      const arr=[start];
      for(let i=1;i<40;i++){
        const last = arr[arr.length-1];
        const change = (Math.random()-0.4)*1.2; // small drift
        arr.push(Math.max(1, +(last+change).toFixed(3)));
      }
      savePoints(arr);
      return arr;
    })();

    // Chart setup
    const ctx = document.getElementById('priceChart').getContext('2d');

    function makeGradient(up=true){
      const g = ctx.createLinearGradient(0,0,0,320);
      if(up){
        g.addColorStop(0, 'rgba(0,210,122,0.16)');
        g.addColorStop(1, 'rgba(0,210,122,0.02)');
      } else {
        g.addColorStop(0, 'rgba(255,77,79,0.12)');
        g.addColorStop(1, 'rgba(255,77,79,0.02)');
      }
      return g;
    }

    const chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: points.map((_,i)=>i),
        datasets: [{
          data: points,
          borderWidth: 2.5,
          borderColor: points.length>1 && (points[points.length-1] >= points[points.length-2]) ? '#00d27a' : '#ff4d4f',
          backgroundColor: makeGradient(points.length>1 && (points[points.length-1] >= points[points.length-2])),
          fill: true,
          tension: 0.35,
          pointRadius: 0,
          pointHoverRadius: 4,
        }]
      },
      options: {
        animation: { duration: SMOOTH_DURATION, easing: 'linear' },
        plugins: { legend:{display:false}, tooltip:{enabled:false} },
        scales: {
          x: { display:false },
          y: { display:false }
        },
        responsive:true,
        maintainAspectRatio:false,
      }
    });

    // UI Elements
    const priceValue = document.getElementById('priceValue');
    const priceArrow = document.getElementById('priceArrow');
    const pointCount = document.getElementById('pointCount');
    const winsEl = document.getElementById('wins');
    const playersEl = document.getElementById('players');
    const payoutEl = document.getElementById('payout');
    const statusText = document.getElementById('statusText');

    function refreshUI(){
      const last = points[points.length-1];
      const prev = points.length>1 ? points[points.length-2] : last;
      const up = last >= prev;
      priceValue.innerText = '$' + (+last).toFixed(3);
      priceArrow.innerText = up ? '▲' : '▼';
      priceArrow.style.color = up ? '#00d27a' : '#ff4d4f';
      priceValue.style.color = up ? '#b8ffd3' : '#ffd6d6';
      pointCount.innerText = points.length;
      // Live info random-ish but stable between refreshes
      winsEl.innerText = Math.floor(10 + (last % 100) * 0.9);
      playersEl.innerText = Math.floor(5 + (last % 50) * 0.6);
      payoutEl.innerText = '$' + ( (last % 250) * 3.14 ).toFixed(2);
    }
    refreshUI();

    // Update logic: append new point while keeping smoothness
    let paused = false;
    let lastTick = Date.now();

    function generateNext(){
      const last = points[points.length-1];
      // create a realistic movement: a mixture of drift + noise + occasional spike
      const drift = (Math.random() - 0.52) * 0.25;              // small drift
      const noise = (Math.random() - 0.5) * 0.6;               // jitter
      const spike = (Math.random() < 0.03) ? (Math.random()*4 - 2) : 0; // rare spike
      const next = Math.max(0.01, +(last + drift + noise + spike).toFixed(3));
      return next;
    }

    function pushPoint(){
      const next = generateNext();
      points.push(next);
      if(points.length > MAX_POINTS) points.shift();
      savePoints(points);

      // update chart dataset
      chart.data.labels = points.map((_,i)=>i);
      chart.data.datasets[0].data = points;

      // color based on last move
      const up = points[points.length-1] >= points[points.length-2];
      chart.data.datasets[0].borderColor = up ? '#00d27a' : '#ff4d4f';
      chart.data.datasets[0].backgroundColor = makeGradient(up);

      chart.update('active'); // smooth update
      refreshUI();
    }

    // Start periodic updates
    let timer = setInterval(()=> {
      if(!paused) pushPoint();
    }, UPDATE_MS);

    // Controls
    document.getElementById('pauseBtn').addEventListener('click', ()=> {
      paused = true;
      statusText.innerText = 'Paused';
      document.getElementById('pauseBtn').style.opacity = 0.6;
      document.getElementById('resumeBtn').style.opacity = 1;
    });
    document.getElementById('resumeBtn').addEventListener('click', ()=> {
      paused = false;
      statusText.innerText = 'Running';
      document.getElementById('pauseBtn').style.opacity = 1;
      document.getElementById('resumeBtn').style.opacity = 0.6;
    });

    // Copy wallet
    document.getElementById('copyBtn').addEventListener('click', async ()=>{
      const txt = document.getElementById('walletAddress').innerText;
      try {
        await navigator.clipboard.writeText(txt);
        alert('Copied: ' + txt);
      } catch(e){
        alert('Copy failed, man — manually copy: ' + txt);
      }
    });

    // Change wallet (quick prompt)
    document.getElementById('changeAddr').addEventListener('click', ()=>{
      const current = document.getElementById('walletAddress').innerText;
      const val = prompt('Enter new wallet address:', current);
      if(val) document.getElementById('walletAddress').innerText = val;
    });

    // Bot prediction buttons
    document.getElementById('btnUp').addEventListener('click', ()=> {
      document.getElementById('botHint').innerText = 'Bot predicts: UP (confidence 78%)';
      // quick flash effect
      flashBorder('#00d27a');
    });
    document.getElementById('btnDown').addEventListener('click', ()=> {
      document.getElementById('botHint').innerText = 'Bot predicts: DOWN (confidence 64%)';
      flashBorder('#ff4d4f');
    });

    function flashBorder(color){
      const el = document.querySelector('.graph-wrap');
      el.style.boxShadow = `0 8px 30px ${hexToRgba(color,0.12)}`;
      setTimeout(()=> el.style.boxShadow = '0 8px 24px rgba(3,6,10,0.6)', 420);
    }
    function hexToRgba(hex, a=1){
      hex = hex.replace('#','');
      const r = parseInt(hex.substring(0,2),16);
      const g = parseInt(hex.substring(2,4),16);
      const b = parseInt(hex.substring(4,6),16);
      return `rgba(${r},${g},${b},${a})`;
    }

    // Clear storage button
    document.getElementById('clearStorage').addEventListener('click', ()=>{
      if(confirm('Clear saved graph points? This will reset persisted history.')){
        localStorage.removeItem(STORAGE_KEY);
        location.reload();
      }
    });

    // Keep UI updated if user left the tab and come back (resync)
    document.addEventListener('visibilitychange', ()=> {
      if(!document.hidden){
        // reload points from storage (maybe changed in another tab)
        const remote = loadPoints();
        if(remote && remote.length){
          points = remote;
          chart.data.datasets[0].data = points;
          chart.update();
          refreshUI();
        }
      }
    });

    // Initial UI ensure
    document.getElementById('pointCount').innerText = points.length;
  </script>
</body>
</html>
