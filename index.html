<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BetWin Game</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background: #0d1117;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    canvas {
      max-width: 600px;
      margin: 20px auto;
      display: block;
      background: #111;
      border: 2px solid #444;
      border-radius: 10px;
    }
    button {
      margin: 10px;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background: limegreen;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      opacity: 0.9;
    }
  </style>
</head>
<body>

  <h1>BetWin Crypto Game</h1>
  <canvas id="gameChart" width="400" height="200"></canvas>
  <p>Balance: $<span id="balance"></span></p>

  <button onclick="predict('up')">Predict UP ðŸ“ˆ</button>
  <button onclick="predict('down')">Predict DOWN ðŸ“‰</button>

  <script>
    const ctx = document.getElementById('gameChart').getContext('2d');

    // Balance system
    let balance = localStorage.getItem("balance") ? parseInt(localStorage.getItem("balance")) : 100;
    document.getElementById("balance").innerText = balance;

    // Load saved graph data or create new
    let savedData = JSON.parse(localStorage.getItem("graphData"));
    let labels = savedData ? savedData.labels : [];
    let dataPoints = savedData ? savedData.dataPoints : [];
    let lastPrice = savedData ? savedData.lastPrice : 100;

    if (labels.length === 0) {
      for (let i = 0; i < 20; i++) {
        labels.push(i.toString());
        dataPoints.push(Math.floor(Math.random() * 100) + 50);
      }
      lastPrice = dataPoints[dataPoints.length - 1];
    }

    const gameChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: labels,
        datasets: [{
          label: 'Crypto Price',
          data: dataPoints,
          borderColor: 'lime',
          borderWidth: 2,
          fill: false,
          tension: 0.3
        }]
      },
      options: {
        animation: false,
        responsive: true,
        scales: {
          y: { beginAtZero: false }
        }
      }
    });

    // Graph update every second
    setInterval(() => {
      labels.shift();
      dataPoints.shift();
      const change = (Math.random() * 10 - 5); // -5 to +5
      lastPrice = Math.max(10, Math.floor(lastPrice + change));
      labels.push((parseInt(labels[labels.length - 1]) + 1).toString());
      dataPoints.push(lastPrice);
      gameChart.update();

      // Save graph data to localStorage
      localStorage.setItem("graphData", JSON.stringify({
        labels: labels,
        dataPoints: dataPoints,
        lastPrice: lastPrice
      }));
    }, 1000);

    // Prediction system
    let currentPrediction = null;
    let predictedPrice = null;

    function predict(direction) {
      if (currentPrediction) {
        alert("â³ Wait for result before placing new prediction!");
        return;
      }

      currentPrediction = direction;
      predictedPrice = lastPrice;
      alert("âœ… Prediction placed: " + direction.toUpperCase());

      setTimeout(() => {
        if ((direction === "up" && lastPrice > predictedPrice) ||
            (direction === "down" && lastPrice < predictedPrice)) {
          balance += 10;
          alert("ðŸŽ‰ You Won! +$10");
        } else {
          balance -= 10;
          alert("âŒ You Lost! -$10");
        }
        document.getElementById("balance").innerText = balance;
        localStorage.setItem("balance", balance);
        currentPrediction = null;
      }, 5000);
    }
  </script>

</body>
</html>
